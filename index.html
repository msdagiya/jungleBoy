<!doctype html> 
<html lang="en"> 
<head> 
    <meta charset="UTF-8" />
    <title>Jungle Boy Game</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/3.18.1/phaser.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Slabo+27px&display=swap" rel="stylesheet"> 
    <style type="text/css">
        body {
            margin: 0;
	    font-family: 'Slabo 27px', serif;
        }
    </style>
</head>
<body style="width:720px;padding:20px;margin:auto auto;">
    <div style="width:360px; float:left;padding:0px 40px; box-sizing:border-box;display:block;"> 
        <a href="https://github.com/msdagiya"><img width="149" height="149" src="https://github.blog/wp-content/uploads/2008/12/forkme_left_red_aa0000.png?resize=149%2C149" class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
        <h1>Jungle Boy Game</h1>
        <p>Use right and left keys to jump the tarzan on the static and movings pads. Collect bananas and Jumps, avoid bird and Jump on birds to get extra jump</p>
    </div>

<script type="text/javascript">
var tarzan;
var background;
var cursors;
var fire;
var bananas;
var score = 0;
var scoreText;
var pads;
var moving_pads;
var bonus;
var path = new Array(200);
var forest;
var coin;
var jump;
var birds;
var loadingText;

class Menu extends Phaser.Scene{
    createStartButton(x,y){
        var Button = this.add.image(x, y, 'Button').setScale(0.1);
	Button
        .setInteractive()
        .on('pointerover', () => {Button.setTexture('Button_hover').setScale(0.1)})
        .on('pointerout', () => {Button.setTexture('Button').setScale(0.1)})
        .on('pointerdown', () => { Button.setTexture('Button_down').setScale(0.1)})
        .on('pointerup', () => {
            this.scene.bringToTop('Play');
            this.scene.start('Play');
        });
    }   
}


class Start extends Menu{
    constructor(){
        super({ key:'Start', active:true});
    }

    preload(){
        this.DisplayLoadingMessege();
        this.LoadPath();
        this.LoadFont();
        this.LoadImages();
        this.LoadAudio();
    }

    LoadPath(){
        this.load.path = 'assets/';
    }

    LoadFont(){
        this.load.bitmapFont('myfont', 'font/font.png', 'font/font.fnt');
    }

    LoadAudio(){
        // Coin Audio Asset
        this.load.audio('Coin', '341695__projectsu012__coins-1.wav');

        // Jump Audio Asset
        this.load.audio('Jump', '350901__cabled-mess__jump-c-06.wav');
    }
 
    LoadImages(){
        // Title assets
        this.load.image('Logo', 'coollogo_com-3156672.png');

        this.load.image('Point', 'cooltext333863632753835.png');

        //Button assets
        this.load.image('Button', 'craftpix-103151-island-game-gui/Island-game-gui/png/buttons/normal/play.png');
        this.load.image('Button_hover', 'craftpix-103151-island-game-gui/Island-game-gui/png/buttons/hover/play.png');
        this.load.image('Button_down', 'craftpix-103151-island-game-gui/Island-game-gui/png/buttons/click/play.png');

        //Bird Assets
        this.load.image('Bird_0', 'PNG/Frame-1.png');
        this.load.image('Bird_1', 'PNG/frame-2.png');
        this.load.image('Bird_2', 'PNG/frame-3.png');
        this.load.image('Bird_3', 'PNG/frame-4.png');



        //Score Assets
        this.load.image('Score','craftpix-103151-island-game-gui/Island-game-gui/png/images/3 stars.png');
        this.load.image('Score2','craftpix-103151-island-game-gui/Island-game-gui/png/images/2 stars.png');
        this.load.image('Score1','craftpix-103151-island-game-gui/Island-game-gui/png/images/1 stars.png');
        this.load.image('Score0','craftpix-103151-island-game-gui/Island-game-gui/png/images/0 stars.png');

        // Banana assets
        this.load.image('Banana', 'craftpix-871511-free-jumping-up-game-items/PNG/Props/Prop_2.png');
        this.load.image('Cone', 'craftpix-871511-free-jumping-up-game-items/PNG/Props/Prop_3.png');
        this.load.image('Jump', 'craftpix-871511-free-jumping-up-game-items/PNG/Bonus_Items/Jump_Bonus_02.png');

        // Pad
        this.load.image('Pad', 'craftpix-871511-free-jumping-up-game-items/PNG/Pads/Pad_02_1.png');

        //Falling Down assets
        this.load.image('Falling_Down_000', 'craftpix-097918-character-island-boy/Character-Island-Boy/png/1/Jump/4.png');
        this.load.image('Falling_Down_001', 'craftpix-097918-character-island-boy/Character-Island-Boy/png/1/Jump/5.png');
        this.load.image('Falling_Down_002', 'craftpix-097918-character-island-boy/Character-Island-Boy/png/1/Jump/6.png');
        this.load.image('Falling_Down_003', 'craftpix-097918-character-island-boy/Character-Island-Boy/png/1/Idle/1.png');

        //Jump Start assets
        this.load.image('Jump_Start_000', 'craftpix-097918-character-island-boy/Character-Island-Boy/png/1/Jump/1.png');
        this.load.image('Jump_Start_001', 'craftpix-097918-character-island-boy/Character-Island-Boy/png/1/Jump/2.png');
        this.load.image('Jump_Start_002', 'craftpix-097918-character-island-boy/Character-Island-Boy/png/1/Jump/3.png');

        //Walking Assets
        this.load.image('Walk_001', 'craftpix-097918-character-island-boy/Character-Island-Boy/png/1/Walk/1.png');
        this.load.image('Walk_002', 'craftpix-097918-character-island-boy/Character-Island-Boy/png/1/Walk/2.png');
        this.load.image('Walk_003', 'craftpix-097918-character-island-boy/Character-Island-Boy/png/1/Walk/3.png');
        this.load.image('Walk_004', 'craftpix-097918-character-island-boy/Character-Island-Boy/png/1/Walk/4.png');
        this.load.image('Walk_005', 'craftpix-097918-character-island-boy/Character-Island-Boy/png/1/Walk/5.png');
        this.load.image('Walk_006', 'craftpix-097918-character-island-boy/Character-Island-Boy/png/1/Walk/6.png');

        //Jump Loop assets
        this.load.image('Jump_Loop_000', 'craftpix-097918-character-island-boy/Character-Island-Boy/png/1/Jump/3.png');

        //Idle assets
        this.load.image('Jump_Idle_000', 'craftpix-097918-character-island-boy/Character-Island-Boy/png/1/Idle/1.png');

        // Background assets
        this.load.image('Background', 'craftpix-809414-cartoon-vertical-game-backgrounds/png/1.png');
    }

    DisplayLoadingMessege(){
        loadingText = this.add.text(180, 300, '0%', { fontSize: '18px', align:'center', fill: '#fff' });
        this.load.on('progress', function (value) {
            loadingText.setText(parseInt(value*100)+'%');
            loadingText.setOrigin(0.5);
        });
    }

    create(){
    	cursors = this.input.keyboard.createCursorKeys();
        //  A simple background for our game
        var background = this.add.image(180, 300, 'Background').setScale(0.35);
        var Logo = this.add.image(180, 275, 'Logo').setScale(0.5);
        this.createStartButton(180,350);
        background.setScrollFactor(0);
    }
}

class Score extends Menu{
    constructor(){
        super({ key:'Score', active:false});
    }

    create(){
    	cursors = this.input.keyboard.createCursorKeys();
        //  A simple background for our game
        var background = this.add.image(180, 300, 'Background').setScale(0.35);
        var Logo = this.add.image(180, 200, 'Logo').setScale(0.5);
        scoreText = this.add.bitmapText(180, 260, 'myfont', score,42); 
        scoreText.setOrigin(0.5);
	
	this.createStartButton(180, 375);
        this.createStars();

	score = 0;
        background.setScrollFactor(0);
    }

    createStars(){
        // Maximum score of 50 is allowed
        if (score < 35) this.add.image(180,300,'Score0').setScale(0.25);
	else if (score < 40) this.add.image(180,300,'Score1').setScale(0.25);
	else if (score < 45) this.add.image(180,300,'Score2').setScale(0.25);
	else this.add.image(180,300,'Score').setScale(0.25);
    }
}

class Play extends Phaser.Scene{
    constructor(){
        super({ key:'Play', active:false});
    }

    create(){
        //  Input Events
        cursors = this.input.keyboard.createCursorKeys();

        coin = this.sound.add('Coin',{loop:false});
        jump = this.sound.add('Jump',{loop:false});

        this.anims.create({
            key: 'falling_down',
            frames: [
                { key: 'Falling_Down_000', frame: null },
                { key: 'Falling_Down_001', frame: null },
                { key: 'Falling_Down_002', frame: null },
                { key: 'Falling_Down_003', frame: null, duration: 50 }
            ],
            frameRate: 50
        });

        this.anims.create({
            key: 'bird_flying',
            frames: [
                { key: 'Bird_0', frame: null },
                { key: 'Bird_1', frame: null },
                { key: 'Bird_2', frame: null },
                { key: 'Bird_3', frame: null }
            ],
            frameRate: 10,
            repeat: -1
        });

        this.anims.create({
            key: 'jump_start',
            frames: [
                { key: 'Jump_Start_000', frame: null },
                { key: 'Jump_Start_001', frame: null },
                { key: 'Jump_Start_002', frame: null, duration: 50}
            ],
            frameRate: 50
        });

        this.anims.create({
            key: 'jump_loop',
            frames: [
                { key: 'Jump_Loop_000', frame: null }
            ],
            frameRate: 20
        });

        this.anims.create({
            key: 'idle',
            frames: [
                { key: 'Jump_Idle_000', frame: null }
            ],
            frameRate: 20
        });

        this.createPath();
        this.createBackground();
        this.createStaticGrassyPads();
	this.createMovingGrassyPads();
        this.createBananas();
        this.createBirds();
        this.createBonuses();
        this.createTarzen();
        this.createScore();
	this.createCamera();

        // Declare Collision and OVerlaps
        this.physics.add.collider(tarzan, pads, this.jumpPad.bind(this));
        this.physics.add.collider(tarzan, moving_pads, this.jumpPad.bind(this));
        this.physics.add.overlap(tarzan, bananas, this.collideBanana.bind(this));
        this.physics.add.overlap(tarzan, bonus, this.powerOverlap);
        this.physics.add.collider(tarzan, birds, this.jumpOnBird.bind(this));


    }

    update(){
        this.updateTarzen();
	this.updateBirds();
        this.updateMovingGrassyPads();
	this.updateBackground();
	this.gameOver();
    }

    createCamera(){
        this.cameras.main.setBounds(0,-20000, 300, 20600);
        this.cameras.main.startFollow(tarzan,1,1, 100,100);
    }
 
    createPath(){
        for (var i = 0; i < 200; i=i+1)
        {
            path[i]= {x: Phaser.Math.Between(50, 250), y:(475-i*100)};
        }
    }

    createStaticGrassyPads(){
        // Some pads to collect, 10 in total
        pads = this.physics.add.group({
	    allowGravity:false,
	    immovable:true,
	    enableBody:true
        });

        for (var i = 0; i < path.length; i=i+2)
        {
	    var pad = pads.create(path[i].x,path[i].y+50, 'Pad').setScale(0.1);
 	    pad.body.checkCollision.down = false;
    	    pad.body.checkCollision.left = false;
    	    pad.body.checkCollision.right = false;
        }
    }

    createMovingGrassyPads(){
        // Some pads to collect, 10 in total
        moving_pads = this.physics.add.group({
	    allowGravity:false,
	    immovable:false,
	    enableBody:true
        });

        for (var i = 1; i < path.length; i=i+2)
        {
	    var pad = moving_pads.create(path[i].x,path[i].y+50, 'Pad').setScale(0.1);
 	    pad.body.checkCollision.down = false;
    	    pad.body.checkCollision.left = false;
    	    pad.body.checkCollision.right = false;
	    pad.setVelocityX(50);
        }
    }


    createBirds(){
        // Some pads to collect, 10 in total
        birds = this.physics.add.group({
	    allowGravity:false,
	    immovable:true,
	    enableBody:true
        });


        for (var i = 0; i < path.length; i=i+1)
        {
	    if((i+2)%20 == 0) {
		var bird = birds.create(path[i].x,path[i].y+100, 'Bird_0').setScale(0.05);
		bird.anims.play('bird_flying', true);
		bird.setVelocityX(50);
            }
        }
    }

    createBananas(){
        //  Some bananas to collect, 10 in total
        bananas = this.physics.add.group({allowGravity:false,immovable:true,enableBody:true});
        for (var i = 0; i < path.length; i=i+1)
        {
	    if(i%4 ==0) var banana = bananas.create(path[i].x,path[i].y, 'Banana').setScale(0.1);
        }
    }

    createScore(){
        //  The score
        var banana = this.add.image(25, 25, 'Banana').setScale(0.1);
        banana.setScrollFactor(0);
        scoreText = this.add.bitmapText(50, 6, 'myfont', score,36 ); 
        scoreText.setScrollFactor(0);
    }

    createBonuses(){
        //  Some bonus to collect, 10 in total
        bonus = this.physics.add.group({allowGravity:false,immovable:true,enableBody:true});
        for (var i = 0; i < path.length; i=i+1)
        {
            if((i+6)%20 == 0) var jump = bonus.create(path[i].x,path[i].y, 'Jump').setScale(0.1); 

        }
    }

    createTarzen(){
        // Declare tarzan
        tarzan = this.physics.add.sprite(180, 500, 'Jump_Idle_000');
        tarzan.setScale(0.045,0.045)﻿;
        tarzan.anims.play('jump_start', true);
        tarzan.setVelocityY(-750);
    }

    createBackground(){
        //  A simple background for our game
        background = this.add.image(180, 300, 'Background').setScale(0.70);
        background.setScrollFactor(0);
    }

    updateBackground(){
	background.setPosition((360-((180*tarzan.x)/180)), (50-((300*tarzan.y)/10000)));
    }


    flipLeft(object,speed){
        object.setVelocityX(-1*speed);
        object.setFlipX(true);
    }

    flipRight(object,speed){  
        object.setVelocityX(speed);
        object.setFlipX(false);
    }

    updateTarzen(){
        if((Math.round(tarzan.body.velocity.y) > 0) 
        && (Math.round(tarzan.body.velocity.y) < 20) 
        &&(!tarzan.body.touching.down)){
	    tarzan.anims.play('falling_down', true);
        }
        if (cursors.right.isDown) this.flipRight(tarzan,200);
        else if (cursors.left.isDown) this.flipLeft(tarzan,200);
        else tarzan.setVelocityX(0);
        if (tarzan.x > 330) this.flipLeft(tarzan,200);
        else if (tarzan.x < 30) this.flipRight(tarzan,200);
    }

    updateBirds(){
        birds.children.each(function(bird) {  
            if (bird.x > 330) this.flipLeft(bird, 50);
            else if (bird.x < 30) this.flipRight(bird,50);
        }, this);
    }

    updateMovingGrassyPads(){
        moving_pads.children.each(function(moving_pad) {  
            if (moving_pad.x > 300) this.flipLeft(moving_pad, 50);
            else if (moving_pad.x < 50) this.flipRight(moving_pad,50);
        }, this);
    }

    jumpPad(tarzan,pad){
        if ((tarzan.body.touching.down) && (pad.body.touching.up)){
            this.tweens
            .add({
                targets: pad,
                alpha: 0,
                duration: 5000,
                ease: 'Power2',
	        onComplete:function(){
                    pad.disableBody(true, true);
	        }
            }, this);
            pad.setAccelerationY(500);
	    tarzan.anims.play('jump_start', true);
            tarzan.setVelocityY(-500);
        }
    }

    jumpOnBird(tarzan,bird){
        if ((tarzan.body.touching.down) && (bird.body.touching.up)){
            jump.play();
            this.tweens
            .add({
                targets: bird,
                alpha: 0,
                duration: 500,
                ease: 'Power2',
	        onComplete:function(){
                    bird.disableBody(true, true);
	        }
            }, this);
            bird.setAccelerationY(500);
	    tarzan.anims.play('jump_start', true);
            tarzan.setVelocityY(-1000);
        }
	else{
            this.scene.bringToTop('Score');
            this.scene.start('Score');
	}
    }

    powerOverlap(tarzan, Bonus){
	jump.play();
        Bonus.disableBody(true, true);
        tarzan.anims.play('jump_start', true);
        tarzan.setVelocityY(-1000);  
    }


    collideBanana(tarzan, banana){
	var self = this;
        if(!banana.hasOverlapped){
            banana.hasOverlapped = true;
            self.tweens
            .add({
                targets: banana,
                alpha: 0,
                scale:0,
                duration: 500,
                ease: 'Power2',
	        onComplete:function(){
                    coin.play();
        	    // Declare tarzan
                    var point_image = self.physics.add.sprite(tarzan.x, tarzan.y-100, 'Point');
                    point_image.setScale(0.5,0.5)﻿;
		    banana.disableBody(true, true);
		    self.tweens
                    .add({
                        targets: point_image,
                        alpha: 0,
                        duration:1000,
                        ease:'Power2',
                        onComplete:function(){
                            point_image.disableBody(true,true);
                        }
                    }, self);
		    score++;
                    scoreText.setText(score);
	        }
            }, self);
        }
    }

    gameOver(){
        if(tarzan.body.velocity.y > 750){
            this.scene.bringToTop('Score');
            this.scene.start('Score');
        }  
    }
}


var config = {
    type: Phaser.AUTO,
    width: 360,
    height: 600,
    physics: {
        default: 'arcade',
        arcade: {
            gravity: { y: 1000 },
            debug: false
        }
    },
    scene: [Start, Play, Score]
};

var game = new Phaser.Game(config);

</script>
</body>
</html>      
  
